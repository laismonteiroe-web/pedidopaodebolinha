<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fa√ßa o pedido do seu P√£o de Bolinha ‚Äì Del√≠cias da Vov√≥</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      margin: 0;
      padding: 0;
      background: #f5f5f5;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      font-size: 16px; /* fonte base maior */
    }

    .container {
      background: #ffffff;
      padding: 28px; /* mais espa√ßo interno */
      max-width: 560px;
      width: 100%;
      border-radius: 14px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
    }

    h1 {
      font-size: 1.6rem; /* maior */
      margin-bottom: 6px;
      text-align: center;
      font-weight: 700;
    }

    p.subtitulo {
      font-size: 1rem;
      color: #555;
      text-align: center;
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-size: 1rem;
      font-weight: 600;
    }

    input,
    select,
    textarea {
      width: 100%;
      padding: 12px 14px; /* maior */
      margin-bottom: 16px;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-size: 1rem;
    }

    textarea {
      min-height: 90px;
      resize: vertical;
    }

    button {
      border: none;
      cursor: pointer;
    }

    .btn-enviar {
      width: 100%;
      padding: 14px;
      border-radius: 999px;
      font-size: 1.1rem; /* maior */
      font-weight: 700;
      background: #25d366;
      color: #fff;
      transition: transform 0.1s ease, box-shadow 0.1s ease,
        background 0.1s ease;
    }

    .btn-enviar:hover {
      background: #1ebe5d;
      box-shadow: 0 4px 10px rgba(37, 211, 102, 0.4);
      transform: translateY(-1px);
    }

    .btn-enviar:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .aviso {
      font-size: 0.9rem;
      color: #777;
      text-align: center;
      margin-top: 12px;
    }

    .obrigatorio {
      color: #d00;
    }

    .campo-oculto {
      display: none;
    }

    small {
      color: #777;
      font-size: 0.85rem;
    }

    .grupo-sabores {
      background: #fafafa;
      border-radius: 10px;
      padding: 12px 14px;
      border: 1px solid #eee;
      margin-bottom: 14px;
    }

    .grupo-sabores h2 {
      font-size: 1.1rem;
      margin: 0 0 8px 0;
      font-weight: 700;
    }

    .grupo-sabores h3 {
      font-size: 1rem;
      margin: 10px 0 6px;
      font-weight: 600;
    }

    .linha-sabor {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 8px;
      padding: 6px 0;
      border-bottom: 1px dashed #eee;
    }

    .linha-sabor:last-child {
      border-bottom: none;
    }

    .nome-sabor {
      font-size: 1rem;
      flex: 1;
    }

    .controle-qtd {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .btn-qtd {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      border: 1px solid #ccc;
      background: #fff;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-qtd:active {
      background: #f0f0f0;
    }

    .qtd-display {
      min-width: 34px;
      text-align: center;
      font-size: 1rem;
      padding: 6px 8px;
      border-radius: 6px;
      border: 1px solid #ddd;
      background: #fff;
    }

    .qtd-input-real {
      display: none;
    }

    /* TEMA ESCURO AUTOM√ÅTICO */
    @media (prefers-color-scheme: dark) {
      body {
        background: #1b1b1b;
        color: #f2f2f2;
      }

      .container {
        background: #2a2a2a;
        box-shadow: 0 0 0 rgba(0, 0, 0, 0);
        border: 1px solid #3a3a3a;
      }

      h1 {
        color: #fff;
      }

      p.subtitulo,
      label,
      small,
      .aviso {
        color: #d7d7d7;
      }

      input,
      select,
      textarea {
        background: #3a3a3a;
        border: 1px solid #555;
        color: #fff;
      }

      input::placeholder,
      textarea::placeholder {
        color: #aaa;
      }

      .grupo-sabores {
        background: #333;
        border: 1px solid #555;
      }

      .linha-sabor {
        border-bottom: 1px dashed #555;
      }

      .btn-qtd {
        border: 1px solid #bbb;
        background: #3a3a3a;
        color: #fff;
      }

      .qtd-display {
        background: #454545;
        border: 1px solid #666;
        color: #fff;
      }

      .btn-enviar {
        background: #128c4a;
      }

      .btn-enviar:hover {
        background: #0e733c;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Pedido de P√£o de Bolinha</h1>
    <p class="subtitulo">
      Escolha os sabores, informe seus dados e envie seu pedido pelo WhatsApp.
    </p>

    <form id="pedidoForm" onsubmit="enviarWhatsApp(event)">
      <label for="nome">
        Nome completo <span class="obrigatorio">*</span>
      </label>
      <input
        type="text"
        id="nome"
        placeholder="Seu nome"
        required
      />

      <label for="telefone">
        Telefone (com DDD) <span class="obrigatorio">*</span>
      </label>
      <input
        type="tel"
        id="telefone"
        placeholder="(11) 99999-9999"
        required
      />

      <!-- SABORES E QUANTIDADES -->
      <div class="grupo-sabores">
        <h2>Sabores de p√£o de bolinha <span class="obrigatorio">*</span></h2>
        <small>Use os bot√µes + e - para escolher a quantidade de cada sabor.</small>

        <h3>Doces</h3>

        <div class="linha-sabor" data-sabor-id="doce_leite">
          <span class="nome-sabor">Doce de leite</span>
          <div class="controle-qtd">
            <button type="button" class="btn-qtd btn-menos">-</button>
            <span class="qtd-display">0</span>
            <button type="button" class="btn-qtd btn-mais">+</button>
          </div>
          <input type="number" id="qtd_doce_leite" class="qtd-input-real" value="0" min="0" />
        </div>

        <div class="linha-sabor" data-sabor-id="chocolate">
          <span class="nome-sabor">Chocolate</span>
          <div class="controle-qtd">
            <button type="button" class="btn-qtd btn-menos">-</button>
            <span class="qtd-display">0</span>
            <button type="button" class="btn-qtd btn-mais">+</button>
          </div>
          <input type="number" id="qtd_chocolate" class="qtd-input-real" value="0" min="0" />
        </div>

        <div class="linha-sabor" data-sabor-id="misto">
          <span class="nome-sabor">Misto (doce de leite e chocolate)</span>
          <div class="controle-qtd">
            <button type="button" class="btn-qtd btn-menos">-</button>
            <span class="qtd-display">0</span>
            <button type="button" class="btn-qtd btn-mais">+</button>
          </div>
          <input type="number" id="qtd_misto" class="qtd-input-real" value="0" min="0" />
        </div>

        <div class="linha-sabor" data-sabor-id="goiabada">
          <span class="nome-sabor">Goiabada</span>
          <div class="controle-qtd">
            <button type="button" class="btn-qtd btn-menos">-</button>
            <span class="qtd-display">0</span>
            <button type="button" class="btn-qtd btn-mais">+</button>
          </div>
          <input type="number" id="qtd_goiabada" class="qtd-input-real" value="0" min="0" />
        </div>

        <h3>Salgados</h3>

        <div class="linha-sabor" data-sabor-id="presunto_queijo">
          <span class="nome-sabor">Presunto e queijo</span>
          <div class="controle-qtd">
            <button type="button" class="btn-qtd btn-menos">-</button>
            <span class="qtd-display">0</span>
            <button type="button" class="btn-qtd btn-mais">+</button>
          </div>
          <input type="number" id="qtd_presunto_queijo" class="qtd-input-real" value="0" min="0" />
        </div>

        <div class="linha-sabor" data-sabor-id="frango">
          <span class="nome-sabor">Frango</span>
          <div class="controle-qtd">
            <button type="button" class="btn-qtd btn-menos">-</button>
            <span class="qtd-display">0</span>
            <button type="button" class="btn-qtd btn-mais">+</button>
          </div>
          <input type="number" id="qtd_frango" class="qtd-input-real" value="0" min="0" />
        </div>

        <div class="linha-sabor" data-sabor-id="quatro_queijos">
          <span class="nome-sabor">Quatro queijos</span>
          <div class="controle-qtd">
            <button type="button" class="btn-qtd btn-menos">-</button>
            <span class="qtd-display">0</span>
            <button type="button" class="btn-qtd btn-mais">+</button>
          </div>
          <input type="number" id="qtd_quatro_queijos" class="qtd-input-real" value="0" min="0" />
        </div>
      </div>

      <!-- Forma de recebimento -->
      <label for="forma">
        Como voc√™ quer receber? <span class="obrigatorio">*</span>
      </label>
      <select id="forma" required>
        <option value="">Selecione</option>
        <option value="retirada">Retirada na loja</option>
        <option value="entrega">Entrega</option>
      </select>

      <!-- Retirada: unidade -->
      <div id="campo-retirada" class="campo-oculto">
        <label for="unidade">
          Unidade para retirada <span class="obrigatorio">*</span>
        </label>
        <select id="unidade">
          <option value="">Selecione a unidade</option>
          <option value="Matriz">Matriz</option>
          <option value="Vila Nova">Vila Nova</option>
        </select>
      </div>

      <!-- Entrega: endere√ßo + pagamento -->
      <div id="campo-entrega" class="campo-oculto">
        <label for="endereco">
          Endere√ßo para entrega <span class="obrigatorio">*</span>
        </label>
        <textarea
          id="endereco"
          placeholder="Rua, n√∫mero, bairro, complemento/ponto de refer√™ncia"
        ></textarea>

        <label for="pagamento">
          Forma de pagamento na entrega <span class="obrigatorio">*</span>
        </label>
        <select id="pagamento">
          <option value="">Selecione</option>
          <option value="pix">Pix</option>
          <option value="maquininha">Maquininha (cart√£o)</option>
          <option value="dinheiro">Dinheiro (troco em m√∫ltiplos de 50)</option>
        </select>
      </div>

      <label for="data">
        Data desejada para retirada/entrega <span class="obrigatorio">*</span><br>
        <small>(Pedidos com no m√≠nimo 1 dia de anteced√™ncia. Aos domingos estamos fechados.)</small>
      </label>
      <input type="date" id="data" required />

      <label for="horario">
        Hor√°rio aproximado <span class="obrigatorio">*</span><br>
        <small>(entre 07:00 e 20:00)</small>
      </label>
      <input
        type="time"
        id="horario"
        required
        min="07:00"
        max="20:00"
      />

      <label for="observacoes">Observa√ß√µes</label>
      <textarea
        id="observacoes"
        placeholder="Detalhes do pedido, informa√ß√µes extras, etc."
      ></textarea>

      <button type="submit" class="btn-enviar">Enviar pedido pelo WhatsApp</button>
    </form>

    <p class="aviso">
      Ao clicar em enviar, voc√™ ser√° direcionado(a) para o WhatsApp com a
      mensagem j√° pronta.
    </p>
  </div>

  <script>
    const numeroWhatsApp = "5511988921216";
    const LS_KEY = "pedidoPaoBolinha";
    let dataMinimaISO = "";

    window.addEventListener("DOMContentLoaded", () => {
      const dataInput = document.getElementById("data");

      // Data m√≠nima (amanh√£)
      const hoje = new Date();
      hoje.setDate(hoje.getDate() + 1); // amanh√£

      const ano = hoje.getFullYear();
      const mes = String(hoje.getMonth() + 1).padStart(2, "0");
      const dia = String(hoje.getDate()).padStart(2, "0");

      dataMinimaISO = `${ano}-${mes}-${dia}`;
      dataInput.min = dataMinimaISO;

      // Bloquear domingos
      dataInput.addEventListener("change", () => {
        if (!dataInput.value) return;

        const dataSelecionada = new Date(dataInput.value + "T00:00:00");
        const diaSemana = dataSelecionada.getDay(); // 0 = domingo

        if (diaSemana === 0) {
          alert("Estamos fechados aos domingos üíõ\nPor favor, escolha outra data.");
          dataInput.value = "";
        }

        salvarDados();
      });

      // Inicializar bot√µes de quantidade
      inicializarBotoesQuantidade();

      // Carregar dados salvos (se houver)
      carregarDados();

      // Configurar salvamento autom√°tico
      configurarSalvamentoAutomatico();

      // Atualizar campos de retirada/entrega com base na forma carregada
      atualizarCamposForma();
    });

    function atualizarCamposForma() {
      const forma = document.getElementById("forma").value;
      const campoRetirada = document.getElementById("campo-retirada");
      const campoEntrega = document.getElementById("campo-entrega");

      if (forma === "retirada") {
        campoRetirada.style.display = "block";
        campoEntrega.style.display = "none";
      } else if (forma === "entrega") {
        campoRetirada.style.display = "none";
        campoEntrega.style.display = "block";
      } else {
        campoRetirada.style.display = "none";
        campoEntrega.style.display = "none";
      }
    }

    // Bot√µes + e -
    function inicializarBotoesQuantidade() {
      const linhas = document.querySelectorAll(".linha-sabor");

      linhas.forEach((linha) => {
        const btnMenos = linha.querySelector(".btn-menos");
        const btnMais = linha.querySelector(".btn-mais");
        const display = linha.querySelector(".qtd-display");
        const inputReal = linha.querySelector(".qtd-input-real");

        btnMenos.addEventListener("click", () => {
          let atual = parseInt(inputReal.value || "0", 10);
          if (atual > 0) {
            atual -= 1;
            inputReal.value = atual;
            display.textContent = atual;
            salvarDados();
          }
        });

        btnMais.addEventListener("click", () => {
          let atual = parseInt(inputReal.value || "0", 10);
          atual += 1;
          inputReal.value = atual;
          display.textContent = atual;
          salvarDados();
        });
      });
    }

    function pegarQuantidade(id) {
      const el = document.getElementById(id);
      if (!el) return 0;
      const valor = el.value.trim();
      if (!valor) return 0;
      const n = parseInt(valor, 10);
      return isNaN(n) ? 0 : n;
    }

    // Coletar todos os dados do formul√°rio para salvar
    function obterDadosFormulario() {
      const dados = {
        nome: document.getElementById("nome").value.trim(),
        telefone: document.getElementById("telefone").value.trim(),
        forma: document.getElementById("forma").value,
        unidade: document.getElementById("unidade").value,
        endereco: document.getElementById("endereco").value.trim(),
        pagamento: document.getElementById("pagamento").value,
        data: document.getElementById("data").value,
        horario: document.getElementById("horario").value,
        observacoes: document.getElementById("observacoes").value.trim(),
        qtds: {
          doce_leite: document.getElementById("qtd_doce_leite").value,
          chocolate: document.getElementById("qtd_chocolate").value,
          misto: document.getElementById("qtd_misto").value,
          goiabada: document.getElementById("qtd_goiabada").value,
          presunto_queijo: document.getElementById("qtd_presunto_queijo").value,
          frango: document.getElementById("qtd_frango").value,
          quatro_queijos: document.getElementById("qtd_quatro_queijos").value,
        },
      };

      return dados;
    }

    // Salvar no localStorage
    function salvarDados() {
      try {
        const dados = obterDadosFormulario();
        localStorage.setItem(LS_KEY, JSON.stringify(dados));
      } catch (e) {
        console.error("Erro ao salvar dados:", e);
      }
    }

    // Carregar do localStorage
    function carregarDados() {
      try {
        const bruto = localStorage.getItem(LS_KEY);
        if (!bruto) return;

        const dados = JSON.parse(bruto);

        if (dados.nome) document.getElementById("nome").value = dados.nome;
        if (dados.telefone) document.getElementById("telefone").value = dados.telefone;
        if (dados.forma) document.getElementById("forma").value = dados.forma;
        if (dados.unidade) document.getElementById("unidade").value = dados.unidade;
        if (dados.endereco) document.getElementById("endereco").value = dados.endereco;
        if (dados.pagamento) document.getElementById("pagamento").value = dados.pagamento;
        if (dados.horario) document.getElementById("horario").value = dados.horario;
        if (dados.observacoes) document.getElementById("observacoes").value = dados.observacoes;

        // Restaurar data se ainda for v√°lida e n√£o for domingo
        if (dados.data) {
          const dataInput = document.getElementById("data");
          const valorData = dados.data;
          if (valorData >= dataMinimaISO) {
            const d = new Date(valorData + "T00:00:00");
            if (d.getDay() !== 0) {
              dataInput.value = valorData;
            }
          }
        }

        // Restaurar quantidades
        if (dados.qtds) {
          const mapa = [
            ["qtd_doce_leite", "doce_leite"],
            ["qtd_chocolate", "chocolate"],
            ["qtd_misto", "misto"],
            ["qtd_goiabada", "goiabada"],
            ["qtd_presunto_queijo", "presunto_queijo"],
            ["qtd_frango", "frango"],
            ["qtd_quatro_queijos", "quatro_queijos"],
          ];

          mapa.forEach(([idInput, chave]) => {
            const input = document.getElementById(idInput);
            const linha = input?.closest(".linha-sabor");
            const display = linha?.querySelector(".qtd-display");
            if (input && display && dados.qtds[chave] != null) {
              const valor = parseInt(dados.qtds[chave], 10);
              if (!isNaN(valor) && valor >= 0) {
                input.value = valor;
                display.textContent = valor;
              }
            }
          });
        }
      } catch (e) {
        console.error("Erro ao carregar dados:", e);
      }
    }

    // Configurar salvamento autom√°tico em campos principais
    function configurarSalvamentoAutomatico() {
      const campos = [
        "nome",
        "telefone",
        "forma",
        "unidade",
        "endereco",
        "pagamento",
        "data",
        "horario",
        "observacoes",
      ];

      campos.forEach((id) => {
        const el = document.getElementById(id);
        if (!el) return;

        const evento =
          el.tagName === "SELECT" || el.type === "date" || el.type === "time"
            ? "change"
            : "input";

        el.addEventListener(evento, () => {
          if (id === "forma") {
            atualizarCamposForma();
          }
          salvarDados();
        });
      });
    }

    function enviarWhatsApp(event) {
      event.preventDefault();

      const nome = document.getElementById("nome").value.trim();
      const telefone = document.getElementById("telefone").value.trim();

      const qtdDoceLeite       = pegarQuantidade("qtd_doce_leite");
      const qtdChocolate       = pegarQuantidade("qtd_chocolate");
      const qtdMisto           = pegarQuantidade("qtd_misto");
      const qtdGoiabada        = pegarQuantidade("qtd_goiabada");
      const qtdPresuntoQueijo  = pegarQuantidade("qtd_presunto_queijo");
      const qtdFrango          = pegarQuantidade("qtd_frango");
      const qtdQuatroQueijos   = pegarQuantidade("qtd_quatro_queijos");

      const forma = document.getElementById("forma").value;
      const unidade = document.getElementById("unidade").value;
      const endereco = document.getElementById("endereco").value.trim();
      const pagamento = document.getElementById("pagamento").value;
      const dataSelecionada = document.getElementById("data").value;
      const horario = document.getElementById("horario").value;
      const observacoes = document
        .getElementById("observacoes")
        .value.trim();

      const totalUnidades =
        qtdDoceLeite +
        qtdChocolate +
        qtdMisto +
        qtdGoiabada +
        qtdPresuntoQueijo +
        qtdFrango +
        qtdQuatroQueijos;

      if (!nome || !telefone || !forma || !dataSelecionada || !horario) {
        alert("Por favor, preencha todos os campos obrigat√≥rios.");
        return;
      }

      if (totalUnidades <= 0) {
        alert("Informe a quantidade em pelo menos um sabor de p√£o de bolinha.");
        return;
      }

      // Valida retirada
      if (forma === "retirada") {
        if (!unidade) {
          alert("Escolha a unidade para retirada (Matriz ou Vila Nova).");
          return;
        }
      }

      let pagamentoTexto = "";
      // Valida entrega + pagamento
      if (forma === "entrega") {
        if (!endereco) {
          alert("Informe o endere√ßo completo para entrega.");
          return;
        }

        if (!pagamento) {
          alert("Selecione a forma de pagamento na entrega.");
          return;
        }

        if (pagamento === "pix") {
          pagamentoTexto = "Pix";
        } else if (pagamento === "maquininha") {
          pagamentoTexto = "Maquininha (cart√£o)";
        } else if (pagamento === "dinheiro") {
          pagamentoTexto = "Dinheiro (troco em m√∫ltiplos de 50)";
        }
      }

      // Data e hor√°rio
      if (dataMinimaISO && dataSelecionada < dataMinimaISO) {
        alert("Os pedidos precisam ser feitos com pelo menos 1 dia de anteced√™ncia.");
        return;
      }

      if (horario < "07:00" || horario > "20:00") {
        alert("O hor√°rio deve ser entre 07:00 e 20:00.");
        return;
      }

      const dataFormatada = new Date(dataSelecionada).toLocaleDateString(
        "pt-BR",
        { timeZone: "America/Sao_Paulo" }
      );

      let formaTexto = "";
      if (forma === "retirada") {
        formaTexto = `Retirada na unidade: ${unidade}`;
      } else if (forma === "entrega") {
        formaTexto = `Entrega no endere√ßo: ${endereco} | Pagamento: ${pagamentoTexto}`;
      }

      let linhasSabores = "";
      function addLinha(nomeSabor, qtd) {
        if (qtd > 0) {
          linhasSabores += `- ${nomeSabor}: ${qtd} unidade(s)%0A`;
        }
      }

      addLinha("Doce de leite", qtdDoceLeite);
      addLinha("Chocolate", qtdChocolate);
      addLinha("Misto (doce de leite e chocolate)", qtdMisto);
      addLinha("Goiabada", qtdGoiabada);
      addLinha("Presunto e queijo", qtdPresuntoQueijo);
      addLinha("Frango", qtdFrango);
      addLinha("Quatro queijos", qtdQuatroQueijos);

      let mensagem = `Ol√°! Quero fazer um pedido de p√£o de bolinha.%0A%0A`;
      mensagem += `Nome: ${nome}%0A`;
      mensagem += `Telefone: ${telefone}%0A`;
      mensagem += `Forma de recebimento: ${formaTexto}%0A`;
      mensagem += `Data desejada: ${dataFormatada}%0A`;
      mensagem += `Hor√°rio aproximado: ${horario}%0A%0A`;
      mensagem += `Sabores e quantidades:%0A${linhasSabores}`;
      mensagem += `%0ATotal de unidades: ${totalUnidades}%0A%0A`;
      mensagem += `Observa√ß√µes: ${observacoes ? observacoes : "Nenhuma."}`;

      const url = `https://wa.me/${numeroWhatsApp}?text=${mensagem}`;
      window.open(url, "_blank");

      // Limpa dados salvos ap√≥s envio
      try {
        localStorage.removeItem(LS_KEY);
      } catch (e) {
        console.error("Erro ao limpar dados salvos:", e);
      }
    }
  </script>
</body>
</html>
